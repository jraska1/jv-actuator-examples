<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.2.5.2.0 (Linux)"/>
	<meta name="created" content="2021-12-23T12:12:52.517403777"/>
	<meta name="changed" content="2022-01-16T12:22:44.336892604"/>
	<style type="text/css">
		@page { margin: 0.79in }
		p { line-height: 115%; margin-bottom: 0.1in; background: transparent }
		h2.cjk { font-family: "Noto Sans CJK SC" }
		h2.ctl { font-family: "Lohit Devanagari" }
		pre.cjk { font-family: "Noto Sans Mono CJK SC", monospace }
		h3.cjk { font-family: "Noto Sans CJK SC" }
		h3.ctl { font-family: "Lohit Devanagari" }
		h4.cjk { font-family: "Noto Sans CJK SC" }
		h4.ctl { font-family: "Lohit Devanagari" }
		a.cjk:link { so-language: zxx }
		a.ctl:link { so-language: zxx }
	</style>
</head>
<body lang="cs-CZ" dir="ltr"><p style="line-height: 100%; margin-bottom: 0in">
<i>Vážení kolegové programátoři, ruku na srdce. Pro kolik z nás
končí svět tím, že commit-ujeme své grandiózní dílo do Gitu.
Vždyť dále se to jenom sestaví Jenkinsem, JAR se někam zkopíruje
a spustí.</i></p>
<p style="line-height: 100%; margin-bottom: 0in"><i>On ale ten svět
po commit-u je daleko košatější a barvitější, než by na první
pohled mohlo vypadat. Pokud se zeptáte kolegů ze support oddělení,
budou vám jistě vyprávět hrůzostrašné historky z provozu
aplikaci (samozřejmě že ne těch vašich).</i></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pokud vás to bude
zajímat, pokusil bych se podívat na některé aspekty vývoje
aplikace z pohledu jejího budoucího provozu.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takto formulované
zadání by bylo jistě hodně široké, takže si vyberu pouze úzkou
část. Podívám se na podporu, kterou mně poskytuje framework
<a class="western" href="https://spring.io/projects/spring-boot">Spring
Boot</a> v oblasti provozu aplikace.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Framework tuto
podporu skrývá pod označení <a class="western" href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html">Spring
Boot Actuator</a>, nebo také „Production-ready Features“. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Jedná se o sadu
nástrojů a rozšíření, které by vám měly pomoci při
zjišťování informací o běžící aplikaci, stavu aplikace a
jejich komponent, využití jejich služeb, monitorování provozu a
podobně. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Zdrojové texty ke
všem níže uvedeným příkladům najdete v Git repository:
<a class="western" href="https://github.com/jraska1/jv-actuator-examples">jraska1/jv-actuator-examples</a></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h2 class="western">Základní informace o Spring Boot Actuator</h2>
<p style="line-height: 100%; margin-bottom: 0in">Framework Spring
Boot poskytuje volitelnou podporu pro správu a monitorování
aplikace za jejího běhu - Actuator. Jedná se o sadu nástrojů
přístupných jako koncové body prostřednictvím rozhraní JMX
nebo HTTP.</p>
<p style="line-height: 100%; margin-bottom: 0in">Vzhledem k tomu, že
nejsem velkým příznivcem JMX, zaměřím se v tomto článku pouze
na přístup ke koncovým bodům prostřednictvím HTTP. Nicméně je
dobré vědět, že tato možnost tady je.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Příklady pro tuto
kapitolu najdete v <a class="western" href="https://github.com/jraska1/jv-actuator-examples/tree/main/example-00">jraska1/jv-actuator-examples/example-00</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h3 class="western">Zařazení Actuator do aplikace 
</h3>
<p style="line-height: 100%; margin-bottom: 0in">Abyste podporu mohli
využít, musíte přidat do Maven projektu závislosti:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in"><font size="1" style="font-size: 8pt"><font color="#080808"><font face="JetBrains Mono, monospace">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace">dependency</font></font><font color="#080808"><font face="JetBrains Mono, monospace">&gt;</font></font></font></p>
<pre class="western" style="background: #ffffff"><font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;org.springframework.boot&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;spring-boot-starter-web&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/<font color="#0033b3">dependency</font>&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;<font color="#0033b3">dependency</font>&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;org.springframework.boot&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;spring-boot-starter-actuator&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/<font color="#0033b3">dependency</font>&gt;</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
To je vše, co potřebujete udělat, aby se vám Actuator přidal do
aplikace, inicioval po startu, a poskytl rozhraní přes HTTP.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pokud si aplikaci
spustíte, pak byste měli vidět něco takového:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora example-00]$ java -jar target/example-00-1.0.0.jar 

  <font size="1" style="font-size: 8pt">.   ____          _            __ _ _</font>
 <font size="1" style="font-size: 8pt">/\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \</font>
<font size="1" style="font-size: 8pt">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</font>
 <font size="1" style="font-size: 8pt">\\/  ___)| |_)| | | | | || (_| |  ) ) ) )</font>
  <font size="1" style="font-size: 8pt">'  |____| .__|_| |_|_| |_\__, | / / / /</font>
 <font size="1" style="font-size: 8pt">=========|_|==============|___/=/_/_/_/</font>
<font color="#26a269"> <font size="1" style="font-size: 8pt">:: Spring Boot :: </font>               (v2.6.1)</font>

<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:39.083 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">c.d.a.example00.Application             </font> : Starting Application v1.0.0 using Java 11.0.13 on fedora with PID 7602 (/home/raska/IdeaProjects/jv-actuator-examples/example-00/target/example-00-1.0.0.jar started by raska in /home/raska/IdeaProjects/jv-actuator-examples/example-00)</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:39.091 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">c.d.a.example00.Application             </font> : No active profile set, falling back to default profiles: default</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:41.182 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">o.s.b.w.embedded.tomcat.TomcatWebServer </font> : Tomcat initialized with port(s): 8080 (http)</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:41.206 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">o.apache.catalina.core.StandardService  </font> : Starting service [Tomcat]</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:41.207 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">org.apache.catalina.core.StandardEngine </font> : Starting Servlet engine: [Apache Tomcat/9.0.55]</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:41.336 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">o.a.c.c.C.[Tomcat].[localhost].[/]      </font> : Initializing Spring embedded WebApplicationContext</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:41.337 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">w.s.c.ServletWebServerApplicationContext</font> : Root WebApplicationContext: initialization completed in 2073 ms</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:42.285 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">o.s.b.a.e.web.EndpointLinksResolver     </font> : Exposing 1 endpoint(s) beneath base path '/actuator'</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:42.359 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">o.s.b.w.embedded.tomcat.TomcatWebServer </font> : Tomcat started on port(s): 8080 (http) with context path ''</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:42.399 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">c.d.a.example00.Application             </font> : Started Application in 4.345 seconds (JVM running for 5.024)</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-16 11:38:42.536 </font><font color="#26a269"> INFO</font> <font color="#a347ba">7602</font> --- [           main] <font color="#2aa1b3">c.d.a.example00.Application             </font> : *** Hello World, greetings from Dwarf ***</font></pre><p style="line-height: 100%; margin-bottom: 0in">
Z výpisu můžete vidět, že se nám něco rozjelo na URL
<b>/actuator</b>. To je přístupový bod do HTTP rozhraní Actuator.
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Vše, co Actuator
umí, poskytuje prostřednictvím tzv. <b>koncových bodů</b>. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pokud se bavíme s
nějakým koncovým bodem Actuator, pak je výsledkem vždy JSON
objekt. Proto používám přehlednější formátování výstupu
přes nástroj <b>jq</b>. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nyní si již můžete
zkusit s ním popovídat (dostaneme přehled dostupných koncových
bodů):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;_links&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;self&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;href&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http://localhost:8080/actuator&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;templated&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">false</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;health-path&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;href&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http://localhost:8080/actuator/health/{*path}&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;templated&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">true</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;health&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;href&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http://localhost:8080/actuator/health&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;templated&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">false</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><h3 class="western">
Povolení koncových bodů a jejich vystavení 
</h3>
<p style="line-height: 100%; margin-bottom: 0in">Aby bylo možné
využívat služeb koncových bodů, je potřeba povolit jejich
spuštění a následně také zpřístupnit je přes HTTP rozhraní.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Implicitní
nastavení je takové, že všechny koncové body Actuator jsou při
startu povoleny až na jednu výjimku, a tou je <b>shutdown</b>. 
</p>
<p style="line-height: 100%; margin-bottom: 0in">Současně však
žádný koncový bod není zpřístupněn přes HTTP opět s jednou
výjimkou, a tou je <b>health</b>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takže si můžete
vyzkoušet:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/health | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Povolení a zpřístupnění koncového bodu se provádí nastavením
parametrů v <b>application.yaml</b><span style="font-weight: normal">:</span></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in"><b>management.endpoint.&lt;id&gt;.enabled</b>
– nastavením parametru na true/false</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in"><b>management.endpoints.web.exposure.include</b>
– seznamu koncových bodů, které mají být přístupny přes
webové rozhraní</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="font-weight: normal; line-height: 100%; margin-bottom: 0in">
Vše bude zřejmější, pokud si ukážeme nastavení pro jednotlivé
komponenty dále.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in"><span style="font-weight: normal">Ještě
pro doplnění uvádím, že zde najdete <a class="western" href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.endpoints">přehled
koncových bodů</a>, které jsou k dispozici v rámci frameworku.</span></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h2 class="western">Informace o aplikaci zjišťované za běhu</h2>
<p style="line-height: 100%; margin-bottom: 0in">Detailní popis
vlastností Spring Boot Actuator pro tuto oblast najdete v kapitole:
<a class="western" href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.endpoints.info">2.10.
Application Information</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in">Příklady pro tuto
kapitolu najdete v <a class="western" href="https://github.com/jraska1/jv-actuator-examples/tree/main/example-01">jraska1/jv-actuator-examples/example-01</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">První oblastí, kde
můžete služby Actuator použít, je zjišťování informací o
aplikaci za jejího běhu.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h3 class="western">Informace o aplikaci 
</h3>
<p style="line-height: 100%; margin-bottom: 0in">Jedná se o koncový
bod <b>info</b>, který poskytuje informace ze čtyř oblastí, a
sice:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<ul>
	<li><p style="line-height: 100%; margin-bottom: 0in"><b>build</b> –
	informace o sestavení aplikace, zdrojem je
	<i>META-INF/build-info.properties</i></p>
	<ul>
		<p style="line-height: 100%; margin-bottom: 0in"><span style="font-variant: normal"><span style="font-style: normal">Tento
		soubor se vám do aplikačního balíku nepřidá sám, musíte v
		</span></span><span style="font-variant: normal"><span style="font-style: normal"><b>pom.xml</b></span></span><span style="font-variant: normal">
		</span><span style="font-variant: normal"><span style="font-style: normal">doplnit
		plugin:</span></span></p>
	</ul>
</ul>
<pre class="western" style="line-height: 100%; margin-left: 0.79in"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><span style="font-variant: normal"><span style="font-style: normal">&lt;</span></span><span style="font-variant: normal"><font color="#0033b3"><span style="font-style: normal">plugin</span></font></span><span style="font-variant: normal"><span style="font-style: normal">&gt;</span></span></font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;org.springframework.boot&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;spring-boot-maven-plugin&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">executions</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">execution</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">            <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">goals</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">                <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">goal</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;build-info&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">goal</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">            <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">goals</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">execution</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">executions</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/</font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">plugin</font></font></font><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font></pre>
<ul>
	<li><p style="line-height: 100%; margin-bottom: 0in"><b>git</b> –
	informace o projektu v GIT repository, zdrojem je <i>git.properties</i></p>
</ul>
<p style="line-height: 100%; margin-left: 0.79in; margin-bottom: 0in">
<span style="font-variant: normal"><span style="font-style: normal">Aby
se vám přidal tento soubor do aplikačního balíku, musíte v
</span></span><span style="font-variant: normal"><span style="font-style: normal"><b>pom.xml</b></span></span><span style="font-variant: normal">
</span><span style="font-variant: normal"><span style="font-style: normal">doplnit
plugin:</span></span></p>
<pre class="western" style="line-height: 100%; margin-left: 0.79in"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><span style="font-variant: normal"><span style="font-style: normal">&lt;</span></span><span style="font-variant: normal"><font color="#0033b3"><span style="font-style: normal">plugin</span></font></span><span style="font-variant: normal"><span style="font-style: normal">&gt;</span></span></font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;pl.project13.maven&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;git-commit-id-plugin&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/</font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">plugin</font></font></font><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font></pre>
<ul>
	<li><p style="line-height: 100%; margin-bottom: 0in"><b>java</b> –
	informace o běhovém prostředí Java</p>
	<li><p style="line-height: 100%; margin-bottom: 0in"><b>env</b> –
	informace o aplikaci specifikované v properties</p>
</ul>
<p style="line-height: 100%; margin-left: 0.79in; margin-bottom: 0in">
Poskytuje všechny informace z properties, které jsou ve skupině
<b>info.*</b>.</p>
<p style="line-height: 100%; margin-left: 0.79in; margin-bottom: 0in">
Pokud chceme do těchto parametrů zařadit i informace z <b>pom.xml</b>,
pak musíme ještě doplnit resource:</p>
<pre class="western" style="line-height: 100%; margin-left: 0.79in"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;<font color="#0033b3">resource</font>&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">directory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;${basedir}/src/main/resources&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">directory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">filtering</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;true&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">filtering</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">includes</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;**/application*.yml&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;**/application*.yaml&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;**/application*.properties&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">includes</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/<font color="#0033b3">resource</font>&gt;</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Všechna potřebná doplnění do <b>pom.xml</b> najdete v příkladech
k této kapitole.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Co je potřeba
nastavit v <b>application.yaml</b>, aby to fungovalo:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">management</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoints</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">web</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">exposure</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- info</font></font></font>
<font color="#080808"><font color="#8c8c8c">  </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">info</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">build</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">enabled</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: true</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">env</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">enabled</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: true</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">git</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">enabled</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: true</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">java</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">enabled</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: true</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">info</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">app</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">name</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;@project.name@&quot;</font></font></font></font>
<font color="#080808"><font color="#067d17">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">description</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;@project.description@&quot;</font></font></font></font>
<font color="#080808"><font color="#067d17">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">version</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;@project.version@&quot;</font></font></font></font>
<font color="#080808"><font color="#067d17">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">produced-by</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;Dwarf's Software Workshop, 2022&quot;</font></font></font></font>
<font color="#080808"><font color="#067d17">  </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">source</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">target</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;@java.version@&quot;</font></font></font></font>
<font color="#067d17">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">encoding</font></font></font><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;@project.build.sourceEncoding@&quot;</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
V první části parametrů je povolen koncový bod <b>info</b>. <span style="font-weight: normal">A
následně v části parametrů </span><i><span style="font-weight: normal">management.info</span></i>
<span style="font-weight: normal">jsou povoleny všechny čtyři
oblasti informací.</span></p>
<p style="line-height: 100%; margin-bottom: 0in"><span style="font-weight: normal">Nakonec
mám sekci parametrů začínajících na </span><i><span style="font-weight: normal">info.*</span></i><span style="font-weight: normal">.
Jejich hodnoty jsou nastaveny při sestavení aplikace z properties
definovaných pro Maven nebo rovnou jako text.</span></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nejdříve spustit
aplikaci:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-01]$ java -jar target/example-01-1.0.0.jar </pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">A takto vypadá
výsledek:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/info | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;app&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Example 01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Examples in Java and Spring Boot - Information about Application&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;1.0.0&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;produced-by&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Dwarf's Software Workshop, 2022&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;source&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;target&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;11.0.13&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;encoding&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UTF-8&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;git&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;branch&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;main&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;commit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;id&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;fd4f80c&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;time&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;2022-01-11T16:46:31Z&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;build&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;artifact&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;example-01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Example 01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;time&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;2022-01-11T17:18:31.436Z&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;1.0.0&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;group&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;cz.dsw.actuator-examples&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;java&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;vendor&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Red Hat, Inc.&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;11.0.13&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;runtime&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;OpenJDK Runtime Environment&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;11.0.13+8&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;jvm&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;OpenJDK 64-Bit Server VM&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;vendor&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Red Hat, Inc.&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;11.0.13+8&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Je ještě jedna možnost, na kterou bych rád upozornil. Vzhledem k
tomu, že oblast <b>env</b> načítá informace z properties, můžeme
je také nastavit při spuštění aplikace. To se může hodit,
pokud si nějak chceme označit jednotlivé instance spuštění,
třeba takto:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-01]$ java -jar target/example-01-1.0.0.jar --info.instance.id=inst-1234 --info.instance.name=my-application</pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">No a pak informace o
běžící instanci dostaneme přes koncový bod <b>info</b>
(zkrácený výpis):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/info | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;instance&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;my-application&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;id&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;inst-1234&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;app&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Example 01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Examples in Java and Spring Boot - Information about Application&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;1.0.0&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;produced-by&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Dwarf's Software Workshop, 2022&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
<font size="1" style="font-size: 8pt"><b>...</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><h3 class="western">
Přehled prostředí</h3>
<p style="line-height: 100%; margin-bottom: 0in">Dalším zdrojem
informací o běžící aplikaci, je koncový bod <b>env</b>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Aby byl přístupný,
tak toto musí být nastaveno v <b>application.yaml</b>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">management</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoints</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">web</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">exposure</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- env</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Po jeho vyvolání
dostanete přehled nastavení proměnných prostředí (je to hodně
dlouhý přehled, proto jsem některé sekce zkrátil tak abyste měli
přehled):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/env | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;activeProfiles&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;propertySources&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;server.ports&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;properties&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;local.server.port&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">8080</font>
        <font size="1" style="font-size: 8pt"><b>}</b></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;commandLineArgs&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;properties&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;info.instance.name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;my-application&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;info.instance.id&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;inst-1234&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>}</b></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;servletContextInitParams&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;properties&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;systemProperties&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;properties&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;sun.desktop&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;gnome&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;awt.toolkit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;sun.awt.X11.XToolkit&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>

<font size="1" style="font-size: 8pt"><b>...</b></font>

        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;sun.io.unicode.encoding&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UnicodeLittle&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;java.class.version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;55.0&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>}</b></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;systemEnvironment&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;properties&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;PATH&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;/home/raska/.local/bin:/home/raska/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;System Environment Property \&quot;PATH\&quot;&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;XAUTHORITY&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;/run/user/1000/.mutter-Xwaylandauth.ODRPF1&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;System Environment Property \&quot;XAUTHORITY\&quot;&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>

<font size="1" style="font-size: 8pt"><b>...</b></font>

        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;SHLVL&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;1&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;System Environment Property \&quot;SHLVL\&quot;&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;HOME&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;/home/raska&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;System Environment Property \&quot;HOME\&quot;&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>}</b></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Config resource 'class path resource [application.yaml]' via location 'optional:classpath:/'&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;properties&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;management.endpoints.web.exposure.include[0]&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;info&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [application.yaml] from example-01-1.0.0.jar - 7:13&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;management.endpoints.web.exposure.include[1]&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;env&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [application.yaml] from example-01-1.0.0.jar - 8:13&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>

<font size="1" style="font-size: 8pt"><b>...</b></font>

        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;node.name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;node01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [application.yaml] from example-01-1.0.0.jar - 31:9&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;node.id&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;local:node01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;origin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [application.yaml] from example-01-1.0.0.jar - 32:7&quot;</font></font>
        <font size="1" style="font-size: 8pt"><b>}</b></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>]</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><h3 class="western">
Seznam objektů ve Spring Context</h3>
<p style="line-height: 100%; margin-bottom: 0in">Posledním zdrojem
informací, který by se vám jako programátorům mohl hodit, je
přehled instancí ve Spring Context po spuštění aplikace –
koncový bod <b>beans</b>. 
</p>
<p style="line-height: 100%; margin-bottom: 0in">Zde si můžete
ověřit, zda framework po startu obsahuje instance tříd, které
potřebujete a můžete je tedy odkazovat přes <i>@Autowired</i>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Aby byl přístupný,
tak toto musí být nastaveno v <b>application.yaml</b>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">management</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoints</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">web</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">exposure</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- beans</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">A takto to vypadá,
pokud si jej zavoláte (opět zkrácený výpis pro přehlednost):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/beans | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;contexts&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;application&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;beans&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;endpointCachingOperationInvokerAdvisor&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;aliases&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [],</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;scope&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;singleton&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;type&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.actuate.endpoint.invoker.cache.CachingOperationInvokerAdvisor&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;resource&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [org/springframework/boot/actuate/autoconfigure/endpoint/EndpointAutoConfiguration.class]&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;dependencies&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.actuate.autoconfigure.endpoint.EndpointAutoConfiguration&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;environment&quot;</font></font>
          <font size="1" style="font-size: 8pt"><b>]</b></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;defaultServletHandlerMapping&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;aliases&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [],</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;scope&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;singleton&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;type&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.web.servlet.HandlerMapping&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;resource&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;dependencies&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration$EnableWebMvcConfiguration&quot;</font></font>
          <font size="1" style="font-size: 8pt"><b>]</b></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;applicationTaskExecutor&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;aliases&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;taskExecutor&quot;</font></font>
          <font size="1" style="font-size: 8pt"><b>],</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;scope&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;singleton&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;type&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;resource&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [org/springframework/boot/autoconfigure/task/TaskExecutionAutoConfiguration.class]&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;dependencies&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;taskExecutorBuilder&quot;</font></font>
          <font size="1" style="font-size: 8pt"><b>]</b></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>

<font size="1" style="font-size: 8pt"><b>...</b></font>

        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;application&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;aliases&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [],</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;scope&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;singleton&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;type&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;cz.dsw.actuator_examples.example01.Application$$EnhancerBySpringCGLIB$$c68d1643&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;resource&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;dependencies&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: []</b></font>
        <font size="1" style="font-size: 8pt"><b>},</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;taskExecutorBuilder&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;aliases&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [],</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;scope&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;singleton&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;type&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.task.TaskExecutorBuilder&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;resource&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;class path resource [org/springframework/boot/autoconfigure/task/TaskExecutionAutoConfiguration.class]&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
          <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;dependencies&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
            <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;spring.task.execution-org.springframework.boot.autoconfigure.task.TaskExecutionProperties&quot;</font></font>
          <font size="1" style="font-size: 8pt"><b>]</b></font>
        <font size="1" style="font-size: 8pt"><b>}</b></font>
      <font size="1" style="font-size: 8pt"><b>},</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;parentId&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Dohledáte zde nejenom jméno instance a třídu, která jí
implementuje, ale také její závislosti na dalších instancích.
Přehled je dost velký, ale grep je mocný nástroj, takže není
třeba se toho bát.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h3 class="western">Vytváření informací za běhu</h3>
<p style="line-height: 100%; margin-bottom: 0in">Prozatím jsem
doloval informace o aplikaci z jejího okolí, ať již to bylo
nastavení prostředí, Java virtuálního stroje, properties a
podobně.</p>
<p style="line-height: 100%; margin-bottom: 0in">Mám ale ještě
jednu možnost, a tou je generování informací rovnou z aplikačního
kódu.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Je to docela
jednoduché. Každá instance třídy registrovaná ve Spring
Context, která implementuje rozhraní <b>InfoContributor</b>,
přidává informace do koncového bodu <b>info</b>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Abych mohl něco
ukázat, tak jsem si převzal implementace aplikačních služeb,
které jsem používal v článcích o aplikačních událostech (ony
jsou triviální, takže je popisovat nebudu, bude jistě stačit
krátký pohled do zdrojových kódů).</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">To, co jsem ale
doplnil navíc, je komponenta:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Component</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#9e880d">@Profile</font>(<font color="#067d17">&quot;service-info&quot;</font>)</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">public class </font><font color="#000000">ServiceInfo </font><font color="#0033b3">implements </font><font color="#000000">InfoContributor </font>{</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(required = </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">false</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">List</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProvider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt; </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">allProviders</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public void </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">contribute</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Info</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Builder </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">builder) {</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">builder.withDetail(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;service-providers&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, (</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">allProviders </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">!= </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">null</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) ? </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">allProviders</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.stream().map(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProvider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">::getInstanceName).collect(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Collectors</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>toList</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">()) : </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Collections</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>emptyList</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">());</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Je sice krátká, ale jistě bude stát za komentář:</p>
<ol>
	<li><p style="line-height: 100%; margin-bottom: 0in">Atribut
	<b>allProviders</b> je injektován z kontextu Spring jako seznam
	objektů implementujících rozhraní ServiceProvider. Takových
	poskytovatelů služeb tam může být několik (nebo také žádný).</p>
	<li><p style="line-height: 100%; margin-bottom: 0in">Implementace
	rozhraní <b>InfoContributor</b> vyžaduje implementaci metody
	<i>contribute(Info.Builder)</i>.</p>
	<p style="line-height: 100%; margin-bottom: 0in">Pokud mám
	neprázdný seznam poskytovatelů, vytvořím informaci s označením
	„<i>service-providers“</i>, ve které jsou názvy instancí
	poskytovatelů služby.</p>
	<li><p style="line-height: 100%; margin-bottom: 0in">Komponenta se
	startuje, pokud mám aktivován profil <b>service-info</b>.</p>
</ol>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takže si vyvolám
aplikaci s aktivním profilem <i>service-info</i>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-01]$ java -jar target/example-01-1.0.0.jar --info.instance.id=inst-1234 --info.instance.name=my-application --spring.profiles.active=service-info</pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pokud se nyní
podívám na koncový bod <b>info</b>, pak bych měl vidět něco
takového (výpis opět zkrácen):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/info | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;instance&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;my-application&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;id&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;inst-1234&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;app&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Example 01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Spring Boot Actuator Examples in Java and Spring Boot - Information about Application&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;1.0.0&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;produced-by&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Dwarf's Software Workshop, 2022&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>

<font size="1" style="font-size: 8pt"><b>...</b></font>

  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;service-providers&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Provider B&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;Provider A&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>]</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Berte to prosím jako jednoduchý příklad. Využití pro vaše
potřeby je potřeba vždy zvážit.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h2 class="western">Sledování stavu aplikace a jednotlivých
komponent</h2>
<p style="line-height: 100%; margin-bottom: 0in">Detailní popis
vlastností Spring Boot Actuator pro tuto oblast najdete v kapitole:
<a class="western" href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.endpoints.health">2.8.
Health Information</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in">Příklady pro tuto
kapitolu najdete v <a class="western" href="https://github.com/jraska1/jv-actuator-examples/tree/main/example-02">jraska1/jv-actuator-examples/example-02</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Teď již víme, co
je aplikace zač. Dále by bylo také dobré zjistit, jak aplikace
jako celek a případně její komponenty fungují. Pro tento účel
je součástí Actuator koncový bod <b>health</b>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Dále se ještě v
rámci povídání o sledování stavu aplikace krátce podívám na
koncový bod <b>loggers</b>, kterým je možné řídit úroveň
zápisu logů.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takto by mělo
vypadat nastavení konfigurace aplikace <b>application.yaml</b><span style="font-weight: normal">,
aby byly koncové body přístupné</span>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">management</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoints</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">web</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">exposure</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- health</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- loggers</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoint</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">health</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">show-details</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: always</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">show-components</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: always</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Aby bylo vidět zařazení volitelných komponent do přehledu stavu
aplikace, udělal jsem v tomto příkladu rozšíření služeb.</p>
<p style="line-height: 100%; margin-bottom: 0in">Vycházel jsem z
původní implementace služeb A a B. Navíc jsem přidal sledování
událostí aplikace s tím, že data o události se zapisují jako
JSON objekt do <b>Redis</b> databáze instalované lokálně.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Abych mohl
přistoupit k Redis databázi, musím si rozšířit závislosti v
Maven projektu o:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;<font color="#0033b3">dependency</font>&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;org.springframework.boot&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">groupId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;spring-boot-starter-data-redis&lt;/</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">artifactId</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;/<font color="#0033b3">dependency</font>&gt;</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Dále jsem doplnit implementace obou služeb A a B o publikování
události a také o zápisy do logů (ty se mně budou hodit při
prezentaci vlastností koncového bodu <i>loggers</i>).</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Jako ukázka bude
postačovat implementace jedné služby:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Service</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">public class </font><font color="#000000">ServiceProviderA </font><font color="#0033b3">implements </font><font color="#000000">ServiceProvider</font>&lt;<font color="#000000">RequestA</font>, <font color="#000000">ResponseA</font>&gt; {</font></font></font>

<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private static final </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Logger </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>logger </i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">LoggerFactory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>getLogger</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProviderA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">TokenFactory </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ApplicationEventPublisher </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">publisher</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Function</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Object</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt; </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">toJson</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">perform</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request) {</font></font></font>
<font color="#080808">        <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>logger</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.debug(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;REQUEST:</font></font></font><font color="#0037a6"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">\n</font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">{}&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">toJson</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.apply(request));</font></font></font>

<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA response </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.tokenInstance(request.getTid(), </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setCode(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseCodeType</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>OK</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setResult(request.getValue() + </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">new </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Random().nextInt((</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">int</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Math</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>max</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(request.getValue() / </font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">2</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">10</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">)));</font></font></font>

<font color="#080808">        <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>logger</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.debug(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;RESPONSE:</font></font></font><font color="#0037a6"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">\n</font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">{}&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">toJson</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.apply(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">));</font></font></font>

<font color="#080808">        <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">publisher</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.publishEvent(</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">new </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ProviderEvent(</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">this</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ProviderEvent</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Phase</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>ANSWERED</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, request, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">));</font></font></font>

<font color="#080808">        <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>logger</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.info(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;Service Provider name='{}' replied to request from node='{}'.&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, getInstanceName(), request.getName());</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">getInstanceName</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;Provider A&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Všechny části by již měly být dostatečné známé, takže je
ponechám bez většího komentáře.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Teď bychom se mohli
podívat, co nám koncový bod <b>health</b> řekne o aplikaci:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nastartovat aplikaci
pro tento příklad:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-02]$ java -jar target/example-02-1.0.0.jar </pre><p style="line-height: 100%; margin-bottom: 0in">
Dále pak zkusit vyvolat:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/health | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;DOWN&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;components&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;diskSpace&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;total&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">210452348928</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;free&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">198957740032</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;threshold&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">10485760</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;exists&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">true</font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;ping&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;redis&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;DOWN&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;error&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost:6379&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Je vidět, že v přehledu mně přibyla komponenta <b>redis</b>, ale
bohužel má problém. Je způsoben tím, že jsem prozatím databázi
nespustil. Pokud to udělám, pak vše již vypadá lépe:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/health | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;components&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;diskSpace&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;total&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">210452348928</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;free&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">198957740032</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;threshold&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">10485760</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;exists&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">true</font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;ping&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;redis&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;6.2.6&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><h3 class="western">
Jak zjistit stav vlastních komponent</h3>
<p style="line-height: 100%; margin-bottom: 0in">Zatím jste mohli
vidět, že mám ve sledování komponentu <b>redis</b>. Ale já bych
chtěl sledovat i své vlastní služby, tedy implementace A a B.</p>
<p style="line-height: 100%; margin-bottom: 0in">Dá se to udělat
opět velice jednoduše. Pokud Spring najde ve svém kontextu nějakou
komponentu, která implementuje rozhraní <b>HealthIndicator</b>, pak
jí při dotazu na stav vyvolá a výsledek zařadí do celkového
přehledu.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takže jsem si
udělal vlastní komponentu pro sledování mých služeb, jedná se
o třídu <b>component/ServicesHealthIndicator</b>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Component</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#9e880d">@Profile</font>(<font color="#067d17">&quot;health-indicator&quot;</font>)</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">public class </font><font color="#000000">ServicesHealthIndicator </font><font color="#0033b3">implements </font><font color="#000000">HealthIndicator </font>{</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(required = </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">false</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">List</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProvider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;&gt; </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">providersA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(required = </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">false</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">List</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProvider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt;&gt; </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">providersB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">TokenFactory </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Health </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">health</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Map</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Boolean</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">details </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">new </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">HashMap&lt;&gt;();</font></font></font>

<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">if </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">providersA </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">!= </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">null</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">)</font></font></font>
<font color="#080808">            <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">for </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProvider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">provider </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">providersA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) {</font></font></font>
<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA request </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.tokenInstance(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setValue(</font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">0</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA response </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">provider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.perform(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>

<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">details</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.put(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">provider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.getInstanceName(), </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.getCode() == </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseCodeType</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>OK</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">            <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">if </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">providersB </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">!= </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">null</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) {</font></font></font>
<font color="#080808">            <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">for </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ServiceProvider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">provider </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">providersB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) {</font></font></font>
<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestB request </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.tokenInstance(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setText(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseB response </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">provider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.perform(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>

<font color="#080808">                <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">details</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.put(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">provider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.getInstanceName(), </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.getCode() == </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseCodeType</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>OK</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">            <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808">        <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">((</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">details</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.values().stream().allMatch(b -&gt; b)) ? </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Health</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>up</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() : </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Health</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>down</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">()).withDetails(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">details</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">).build();</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Nejdříve jsem si nechal injektovat všechny objekty implementující
rozhraní služby A do <i>providersA</i>, a rozhraní služby B do
<i>providersB</i>. Opět nevím, jestli při spuštění nějaké
takové budou a případně kolik jich bude, takže seznamy mohou
obsahovat několik instancí nebo být null (žádné takové
nejsou).</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Dále abych naplnil
požadavek rozhraní HealthIndicator, musím implementovat metodu
<b>health()</b>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pro každé rozhraní
vytvořím požadavek, který do něj pošlu a očekávám odpověď.
V případě, že dostanu odpověď OK, tak předpokládám, že
služba funguje.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in"><i><b>Toto je pouze
příklad, kdy mohu volně vyvolávat aplikační služby. V reálu
tohle asi není úplně vždy možné, ale pak si jistě svůj test
vymyslíte jinak.</b></i></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Výsledek testu
zapisují do detailu, který bude připojen k celkovému stavu v
rámci návratové hodnoty metody.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pokud si tuto
komponentu při startu povolím, pak bych již měl dostat v přehledu
také stav mých dvou implementací.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takže spustit
aplikaci s profilem <i>health-indicator</i>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-02]$ java -jar target/example-02-1.0.0.jar --spring.profiles.active=health-indicator</pre><p style="line-height: 100%; margin-bottom: 0in">
A následně se můžete podívat, co nám řekne koncový bod
<i>health</i>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/health | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;components&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;diskSpace&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;total&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">210452348928</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;free&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">198987350016</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;threshold&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">10485760</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;exists&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">true</font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;ping&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;redis&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;version&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;6.2.6&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;services&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;status&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;UP&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;details&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;Provider A&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">true</font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;Provider B&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">true</font>
      <font size="1" style="font-size: 8pt"><b>}</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Přibyla mně komponenta <b>services</b> se stavem označeným za
funkční, a s výsledky testů jednotlivých poskytovatelů služeb.</p>
<p style="line-height: 100%; margin-bottom: 0in">Název komponenty je
odvozen od názvu třídy implementující rozhraní HealthIndicator,
což je <i><span style="font-weight: normal">ServicesHealthIndicator</span></i>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Abyste si mohli
vyzkoušet jak to vypadá, když nějaká služba nefunguje, tak jsem
přidal ještě jednu implementaci služby
<i>component/ServiceProviderAFlawed</i>. Ta se spustí při nastavení
profilu <i>service-flawed</i>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takže ještě
jednou spustit aplikaci, tentokrát s profily <i>health-indicator</i><span style="font-variant: normal">
</span><span style="font-variant: normal"><span style="font-style: normal">a
</span></span><i>service-flawed</i><span style="font-variant: normal"><span style="font-style: normal">:</span></span></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="font-variant: normal; font-style: normal; line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-02]$ java -jar target/example-02-1.0.0.jar --spring.profiles.active=health-indicator,service-flowed</pre><p style="font-variant: normal; font-style: normal; line-height: 100%; margin-bottom: 0in">
A výsledek po otestování:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="font-variant: normal; font-style: normal; line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/health | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;status&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font color="#26a269"><font size="1" style="font-size: 8pt"><span style="font-style: normal">&quot;DOWN&quot;</span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;components&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;diskSpace&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;status&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font color="#26a269"><font size="1" style="font-size: 8pt"><span style="font-style: normal">&quot;UP&quot;</span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;details&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;total&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">210452348928</span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;free&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">198957477888</span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;threshold&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">10485760</span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;exists&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">true</span></font>
      <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>}</b></span></font>
    <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>},</b></span></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;ping&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;status&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font color="#26a269"><font size="1" style="font-size: 8pt"><span style="font-style: normal">&quot;UP&quot;</span></font></font>
    <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>},</b></span></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;redis&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;status&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font color="#26a269"><font size="1" style="font-size: 8pt"><span style="font-style: normal">&quot;UP&quot;</span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;details&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;version&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font color="#26a269"><font size="1" style="font-size: 8pt"><span style="font-style: normal">&quot;6.2.6&quot;</span></font></font>
      <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>}</b></span></font>
    <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>},</b></span></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;services&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;status&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font color="#26a269"><font size="1" style="font-size: 8pt"><span style="font-style: normal">&quot;DOWN&quot;</span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;details&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: {</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;Provider A - Flawed&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">false</span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;Provider A&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">true</span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>,</b></span></font>
        <font color="#12488b"><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>&quot;Provider B&quot;</b></span></font></font><font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>: </b></span></font><font size="1" style="font-size: 8pt"><span style="font-style: normal">true</span></font>
      <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>}</b></span></font>
    <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>}</b></span></font>
  <font size="1" style="font-size: 8pt"><span style="font-style: normal"><b>}</b></span></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="font-variant: normal; font-style: normal; line-height: 100%; margin-bottom: 0in">
Protože jedna ze služeb nahlásila chybu, celá komponenta je
označena jako nefunkční.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<h3 class="western">Nastavení úrovně logování za běhu aplikace</h3>
<p style="line-height: 100%; margin-bottom: 0in">Pokud se v běhu
aplikace objeví nějaký problém, obvykle prvním krokem každého
programátora nebo správce je nastavení detailnější úrovně
logování s očekáváním, že z těch detailnějších logů bude
možné poznat, v čem problém vězí. Jestli je to naivní
očekávání či nikoliv tady řešit nebudu. V tomto momentu mne
zajímá, jak to udělat.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nastavení logerů,
úroveň logování a formát zpráv je obvykle uděláno v
konfiguračním souboru aplikace. Ten je ale schován v JAR balíčku
a načítá se při startu. Takže pro jeho změnu bych potřeboval
minimálně restart aplikace (ono je možné dodat konfigurační
soubor i externě).</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Možností, jak
nastavit úroveň logování za běhu, je koncový bod <b>loggers</b>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Můžete si
vyzkoušet jej zavolat (toto je opět hodně zkrácený výpis):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/loggers | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;levels&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;OFF&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;ERROR&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;WARN&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;DEBUG&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;TRACE&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;loggers&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;ROOT&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;_org&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;_org.springframework&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
<font size="1" style="font-size: 8pt">...</font></p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;reactor.util&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;reactor.util.Loggers&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>},</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;groups&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;web&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;members&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.core.codec&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.http&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.web&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.actuate.endpoint.web&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.boot.web.servlet.ServletContextInitializerBeans&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;sql&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;members&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.springframework.jdbc.core&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.hibernate.SQL&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;org.jooq.tools.LoggerListener&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Opět se dá grepovat, nebo protože vím, jakou třídu chci
detailněji sledovat můžu vybírat i přes <i>jq</i>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takže se dále
zaměřím na všechny třídy v package <i>component</i>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/loggers | jq '.loggers.&quot;cz.dsw.actuator_examples.example02.component&quot;'
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;INFO&quot;</font></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Mohu si změnit efektivní úroveň logování:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora ~]$ jo configuredLevel=DEBUG | curl -s -X POST -d @- -H 'Content-Type:application/json' http://localhost:8080/actuator/loggers/cz.dsw.actuator_examples.example02.component</pre><p style="line-height: 100%; margin-bottom: 0in">
A následně si zkontrolovat výsledek:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/loggers | jq '.loggers.&quot;cz.dsw.actuator_examples.example02.component&quot;'
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;configuredLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;DEBUG&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;effectiveLevel&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;DEBUG&quot;</font></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Abych vydráždil službu, zavolám její REST rozhraní:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ jo -p nid=local:node02 name=node02 tid=${RANDOM} value=100 | curl -s -X GET --data-binary @- -H &quot;Content-type: application/json&quot; http://localhost:8080/rest/serviceA | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;nid&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;local:node01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;node01&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tid&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;14249&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;ts&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;2022-01-14T18:01:45.580+00:00&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;code&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;OK&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;result&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">122</font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
A ve výpisu aplikace byste měli vidět něco takového:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-14 19:01:45.580 </font><font color="#26a269">DEBUG</font> <font color="#a347ba">5307</font> --- [nio-8080-exec-6] <font color="#2aa1b3">c.d.a.e.component.ServiceProviderA      </font> : REQUEST:</font>
<font size="1" style="font-size: 8pt">{</font>
  <font size="1" style="font-size: 8pt">&quot;nid&quot; : &quot;local:node02&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;name&quot; : &quot;node02&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;tid&quot; : &quot;14249&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;ts&quot; : &quot;2022-01-14T18:01:45.579+00:00&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;value&quot; : 100</font>
<font size="1" style="font-size: 8pt">}</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-14 19:01:45.580 </font><font color="#26a269">DEBUG</font> <font color="#a347ba">5307</font> --- [nio-8080-exec-6] <font color="#2aa1b3">c.d.a.e.component.ServiceProviderA      </font> : RESPONSE:</font>
<font size="1" style="font-size: 8pt">{</font>
  <font size="1" style="font-size: 8pt">&quot;nid&quot; : &quot;local:node01&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;name&quot; : &quot;node01&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;tid&quot; : &quot;14249&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;ts&quot; : &quot;2022-01-14T18:01:45.580+00:00&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;code&quot; : &quot;OK&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;result&quot; : 122</font>
<font size="1" style="font-size: 8pt">}</font>
<font size="1" style="font-size: 8pt"><font color="#aaaaaa">2022-01-14 19:01:45.580 </font><font color="#26a269"> INFO</font> <font color="#a347ba">5307</font> --- [nio-8080-exec-6] <font color="#2aa1b3">c.d.a.e.component.ServiceProviderA      </font> : Service Provider name='Provider A' replied to request from node='node02'.</font></pre><h2 class="western">
Metriky provozu aplikace</h2>
<p style="line-height: 100%; margin-bottom: 0in">Detailní popis
vlastností Spring Boot Actuator pro tuto oblast najdete v kapitole:
<a class="western" href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.metrics">6.
Metrics</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in">Příklady pro tuto
kapitolu najdete v <a class="western" href="https://github.com/jraska1/jv-actuator-examples/tree/main/example-03">jraska1/jv-actuator-examples/example-03</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nyní již máme
představu z čeho je aplikace poskládaná, v jakém prostředí
běží, a nakonec také o tom, jak fungují její části a aplikace
jako celek.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nemáme zatím ale
úplně představu, jak je naše aplikace využívaná. Můžeme se
podívat do logů a z toho něco odhadovat, ale lepší je zjistit
metriky jejího provozu. A právě o tom je tato kapitola.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Spring Boot má pro
tento účel zakomponovánu podporu pro napojení na monitorovací
systémy – <a class="western" href="https://micrometer.io/">Micrometer</a>.
Přes toto rozhraní je možné napojení aplikace na širokou škálu
systémů. Podívejte se na výše uvedené odkazy, je jich ke
dvaceti.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Napojení na nějaký
takový systém ukážu někdy příště. Nyní si vystačím s
další podporou zabudovanou rovnou do framework – koncový bod
<b>metrics</b>. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">S jeho pomocí si
můžete kdykoliv zjistit všechny metriky podporované aplikací.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nejdříve opět
povolit koncový bod v konfiguraci <b>application.yaml</b>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">management</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoints</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">web</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">exposure</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- metrics</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">node</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">name</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: node01</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">id</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: local:${node.name}</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">A spustit aplikaci:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-03]$ java -jar target/example-03-1.0.0.jar</pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Přehled dostanete,
pokud si zavoláte přímo koncový bod:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;names&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;application.ready.time&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;application.started.time&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;disk.free&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;disk.total&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.active&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.completed&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.pool.core&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.pool.max&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.pool.size&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.queue.remaining&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;executor.queued&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http.server.requests&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.buffer.count&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.buffer.memory.used&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.buffer.total.capacity&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.classes.loaded&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.classes.unloaded&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.gc.live.data.size&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.gc.max.data.size&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.gc.memory.allocated&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.gc.memory.promoted&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.gc.overhead&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.gc.pause&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.memory.committed&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.memory.max&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.memory.usage.after.gc&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.memory.used&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.threads.daemon&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.threads.live&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.threads.peak&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;jvm.threads.states&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;logback.events&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;process.cpu.usage&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;process.files.max&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;process.files.open&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;process.start.time&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;process.uptime&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;system.cpu.count&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;system.cpu.usage&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;system.load.average.1m&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;tomcat.sessions.active.current&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;tomcat.sessions.active.max&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;tomcat.sessions.alive.max&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;tomcat.sessions.created&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;tomcat.sessions.expired&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
    <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;tomcat.sessions.rejected&quot;</font></font>
  <font size="1" style="font-size: 8pt"><b>]</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Vidíte, že i v základu jich je docela dost.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Konkrétní metriku
získáte tak, že jí přidáte do URL:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/process.cpu.usage | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;process.cpu.usage&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;The \&quot;recent cpu usage\&quot; for the Java Virtual Machine process&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;VALUE&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">0.0020735771617175864</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: []</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Nebo pokud se podívám na metriky pro HTTP rozhraní:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/http.server.requests | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http.server.requests&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;seconds&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;COUNT&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">13.0</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;TOTAL_TIME&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">0.5736550629999999</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;MAX&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">0.007522524</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;exception&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;InvalidEndpointBadRequestException&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;None&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;method&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;GET&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;uri&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;/actuator/metrics/{requiredMetricName}&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;/actuator/metrics&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;outcome&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;CLIENT_ERROR&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;SUCCESS&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;status&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;400&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;200&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>]</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Je to přece jen delší výpis, ve kterém nám přibylo pole
přidělených tagů. Ty nám mohou posloužit pro detailnější
rozčlenění metrik.</p>
<p style="line-height: 100%; margin-bottom: 0in">Tak například,
pokud by mne zajímaly HTTP metriky pouze pro dotazy, na které byl
návratový kód 400, pak bych mohl hodnotu tagu specifikovat v
dotazovacím řetězci:</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/http.server.requests?tag=status:400 | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http.server.requests&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;seconds&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;COUNT&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">1.0</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;TOTAL_TIME&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">0.039342911</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;MAX&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">0.0</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;exception&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;InvalidEndpointBadRequestException&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;method&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;GET&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;uri&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;/actuator/metrics/{requiredMetricName}&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;tag&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;outcome&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;values&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
        <font color="#26a269"><font size="1" style="font-size: 8pt">&quot;CLIENT_ERROR&quot;</font></font>
      <font size="1" style="font-size: 8pt"><b>]</b></font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>]</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><h3 class="western">
Metriky vlastních služeb</h3>
<p style="line-height: 100%; margin-bottom: 0in">Doposud jsem
přistupoval pouze k metrikám, které jsou zabodované rovnou do
framework. Mohu si ale přidat i vlastní, a to docela jednoduše.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Pokud do Spring
kontextu doplním instanci implementující funkční rozhraní
<b>MeterBinder</b>, pak je při startu aplikace mezi metriky zařazena
nová. 
</p>
<p style="line-height: 100%; margin-bottom: 0in">Novou metriku
vytvořím pomocí statické metody <b>Gauge.builder(String,
Supplier&lt;Number&gt;)</b> a jejím zařazením do registry všech
metrik.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Takto vypadá
doplněná třída implementující poskytovatele služby A o metriky
průměru a směrodatné odchylky návratové hodnoty:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Service</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">public class </font><font color="#000000">ServiceProviderA </font><font color="#0033b3">implements </font><font color="#000000">ServiceProvider</font>&lt;<font color="#000000">RequestA</font>, <font color="#000000">ResponseA</font>&gt; {</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">TokenFactory </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">SummaryStatistics </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">new </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">SummaryStatistics();</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">perform</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request) {</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA response </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.tokenInstance(request.getTid(), </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setCode(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseCodeType</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>OK</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">long </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">value </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= request.getValue() + </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">new </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Random().nextInt((</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">int</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">) </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Math</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>max</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(request.getValue() / </font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">2</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">10</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">));</font></font></font>

<font color="#080808">        <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.addValue(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">value</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>

<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setResult(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">value</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">getInstanceName</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;Provider A&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Bean</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Profile</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;service-metrics&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">)</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">MeterBinder </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">valueMean</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(registry) -&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Gauge</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>builder</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;services.A.mean&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">::getMean).register(registry);</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Bean</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Profile</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;service-metrics&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">)</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">MeterBinder </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">valueDeviation</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(registry) -&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Gauge</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>builder</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;services.A.deviation&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">::getStandardDeviation).register(registry);</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
Registrace metrik se provádí pouze pokud máte zadán profil
<i><span style="font-weight: normal">service-metrics</span></i> (to
je volba, aby se mně nepletly při úvodním seznámení s
implicitními metrikami framework).</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">A doplním ještě
sledování metrik pro poskytovatele služby B, tentokrát budu
sledovat minimum a maximum délky zadaného řetězce:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Service</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">public class </font><font color="#000000">ServiceProviderB </font><font color="#0033b3">implements </font><font color="#000000">ServiceProvider</font>&lt;<font color="#000000">RequestB</font>, <font color="#000000">ResponseB</font>&gt; {</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">TokenFactory </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">SummaryStatistics </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">new </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">SummaryStatistics();</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseB </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">perform</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestB </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request) {</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseB response </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.tokenInstance(request.getTid(), </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseB</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setCode(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseCodeType</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>OK</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">long </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">length </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= request.getText().length();</font></font></font>

<font color="#080808">        <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.addValue(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">length</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>

<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setText(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;text length: &quot; </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">+ </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">length</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">getInstanceName</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;Provider B&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Bean</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Profile</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;service-metrics&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">)</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">MeterBinder </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">valueMinimum</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(registry) -&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Gauge</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>builder</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;services.B.minimum&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">::getMin).register(registry);</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Bean</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Profile</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;service-metrics&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">)</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">MeterBinder </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">valueMaximum</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(registry) -&gt; </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Gauge</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>builder</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;services.B.maximum&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">stat</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">::getMax).register(registry);</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font></pre><h4 class="western">
Jak si to vyzkoušet</h4>
<p style="line-height: 100%; margin-bottom: 0in">Vyzkoušení bude
chtít trochu více akcí s přípravou dat, aby bylo z těch metrik
něco vidět.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Budu potřebovat
spustit aplikaci s profilem <i>service-metrics</i>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora example-03]$ java -jar target/example-03-1.0.0.jar --spring.profiles.active=service-metrics</pre><p style="line-height: 100%; margin-bottom: 0in">
Nejdříve se můžeme ujistit, že jsou moje metriky registrované:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics | jq .names | grep services
  <font size="1" style="font-size: 8pt">&quot;</font><font color="#c01c28"><font size="1" style="font-size: 8pt"><b>services</b></font></font><font size="1" style="font-size: 8pt">.A.deviation&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;</font><font color="#c01c28"><font size="1" style="font-size: 8pt"><b>services</b></font></font><font size="1" style="font-size: 8pt">.A.mean&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;</font><font color="#c01c28"><font size="1" style="font-size: 8pt"><b>services</b></font></font><font size="1" style="font-size: 8pt">.B.maximum&quot;,</font>
  <font size="1" style="font-size: 8pt">&quot;</font><font color="#c01c28"><font size="1" style="font-size: 8pt"><b>services</b></font></font><font size="1" style="font-size: 8pt">.B.minimum&quot;,</font></pre><p style="line-height: 100%; margin-bottom: 0in">
Takže nejdříve si zkusím službu A trochu více potrápit (tímto
budu generovat dotazy):</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora ~]$ while true; do jo -p nid=local:node02 name=node02 tid=${RANDOM} value=${RANDOM} | curl -s -X GET --data-binary @- -H &quot;Content-type: application/json&quot; http://localhost:8080/rest/serviceA | jq .result; sleep 1; done</pre><p style="line-height: 100%; margin-bottom: 0in">
No a pak se mohu podívat na metriky pro službu A:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/services.A.mean | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;services.A.mean&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;VALUE&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">22222.794871794868</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: []</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font>
[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/services.A.deviation | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;services.A.deviation&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;VALUE&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">12942.809162549753</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: []</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
A pro službu B by to mohlo vypadat nějak takto:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%; margin-bottom: 0.2in">[raska@fedora ~]$ for l in $(cat /dev/urandom | tr -dc &quot;\t\n [:alnum:]&quot; | head -n 10); do jo -p nid=local:node03 name=node03 tid=$RANDOM text=$l |  curl -s -X GET --data-binary @- -H &quot;Content-type: application/json&quot; http://localhost:8080/rest/serviceB | jq .text; sleep 1; done</pre><p style="line-height: 100%; margin-bottom: 0in">
Metriky pak mohu zjistit:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/services.B.minimum | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;services.B.minimum&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;VALUE&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">1.0</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: []</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<pre class="western" style="line-height: 100%">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/metrics/services.B.maximum | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;name&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;services.B.maximum&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;description&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;baseUnit&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#171421"><font size="1" style="font-size: 8pt"><b>null</b></font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;measurements&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: [</b></font>
    <font size="1" style="font-size: 8pt"><b>{</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;statistic&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;VALUE&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;value&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">48.0</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>],</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;availableTags&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: []</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p style="line-height: 100%; margin-bottom: 0in">
<br/>

</p>
<h2 class="western">Zásahy do běžící aplikace</h2>
<p style="line-height: 100%; margin-bottom: 0in">Detailní popis
vlastností Spring Boot Actuator pro tuto oblast najdete v kapitole:
<a class="western" href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.endpoints.implementing-custom">2.7.
Implementing Custom Endpoints</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in">Příklady pro tuto
kapitolu najdete v <a class="western" href="https://github.com/jraska1/jv-actuator-examples/tree/main/example-04">jraska1/jv-actuator-examples/example-04</a>.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Poslední oblastí,
na kterou bych se rád podíval, je vytváření vlastního koncového
bodu Actuator. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Proč bych to měl
chtít dělat? 
</p>
<p style="line-height: 100%; margin-bottom: 0in">V tomto případě
se fantazii meze nekladou. Na druhou stranu nemá asi moc smysl
suplovat tím běžné aplikační rozhraní. 
</p>
<p style="line-height: 100%; margin-bottom: 0in">Co kdybych ale chtěl
měnit chování mé aplikace za běhu, to by asi smysl dávalo.
Běžně nastavuji chování aplikace pomocí parametrů zadaných v
properties. Pro jejich změnu ale potřebuji minimálně restartovat
aplikaci. Přes koncový bod by to mohlo jít i bez restartu.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Jako ukázku jsem si
vybral nastavení dvou parametrů <i>margin</i> a <i>divider</i>,
které používám při výpočtu návratové hodnoty poskytovatele
služby A. 
</p>
<p style="line-height: 100%; margin-bottom: 0in">Vytvořím tedy
koncový bod <b>application</b>, pomocí kterého bych měl být
schopen zobrazit svoje parametry a také je změnit. 
</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Postup je v podstatě
jednoduchý a přímočarý.</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<p style="line-height: 100%; margin-bottom: 0in">Nejdříve si musím
koncový bod <span style="font-variant: normal"><span style="font-style: normal"><b>application</b></span></span>
zařadit do Actuator a povolit přístup k němu, a to nastavením
parametrů v <b>application.yaml</b>:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">management</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoint</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">application</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">enabled</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: true</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">endpoints</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">web</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">      <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">exposure</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">include</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">:</font></font></font>
<font color="#080808">          <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">- application</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">node</font>:</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">name</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: node01</font></font></font>
<font color="#080808">  <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">id</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">: local:${node.name}</font></font></font></pre><p style="line-height: 100%; margin-bottom: 0in">
A dále upravím implementaci poskytovatele služby A takto:</p>
<p style="line-height: 100%; margin-bottom: 0in"><br/>

</p>
<pre class="western" style="line-height: 100%"><font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Service</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#9e880d">@Endpoint</font>(id = <font color="#067d17">&quot;application&quot;</font>)</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><font color="#0033b3">public class </font><font color="#000000">ServiceProviderA </font><font color="#0033b3">implements </font><font color="#000000">ServiceProvider</font>&lt;<font color="#000000">RequestA</font>, <font color="#000000">ResponseA</font>&gt; {</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Autowired </font></font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">TokenFactory </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>

<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private long </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">margin </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">10</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">private long </font></font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">divider </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#1750eb"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">2</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">perform</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">RequestA </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">request) {</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA response </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">factory</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.tokenInstance(request.getTid(), </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseA</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">class</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setCode(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">ResponseCodeType</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>OK</i></font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#0033b3">          <font size="1" style="font-size: 8pt"><font face="JetBrains Mono, monospace">long </font><font color="#000000"><font face="JetBrains Mono, monospace">value </font></font><font face="JetBrains Mono, monospace">= new Random().nextInt((int) </font><font color="#000000"><font face="JetBrains Mono, monospace">Math</font></font><font face="JetBrains Mono, monospace">.</font><font face="JetBrains Mono, monospace"><i>max</i></font><font face="JetBrains Mono, monospace">(</font><font color="#000000"><font face="JetBrains Mono, monospace">Math</font></font><font face="JetBrains Mono, monospace">.</font><font face="JetBrains Mono, monospace"><i>min</i></font><font face="JetBrains Mono, monospace">(request.getValue() / </font><font color="#871094"><font face="JetBrains Mono, monospace">divider</font></font><font face="JetBrains Mono, monospace">, </font><font color="#871094"><font face="JetBrains Mono, monospace">margin</font></font><font face="JetBrains Mono, monospace">), </font><font color="#1750eb"><font face="JetBrains Mono, monospace">1</font></font><font face="JetBrains Mono, monospace">));</font></font></font>
<font color="#080808">        <font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.setResult(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">value</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">response</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@Override</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">getInstanceName</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;Provider A&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@ReadOperation</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Map</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&lt;</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Long</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&gt; </font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">getData</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">() {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">return </font></font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Map</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">.</font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt"><i>of</i></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;margin&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">,</font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">margin</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;divider&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">, </font></font><font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">divider</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">);</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>

<font color="#080808">    <font color="#9e880d"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">@WriteOperation</font></font></font></font>
<font color="#080808"><font color="#9e880d">    </font><font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">public void </font></font></font><font color="#00627a"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">postData</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(</font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">String </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">name, </font></font><font color="#000000"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">Long </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">value) {</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">if </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(name.equalsIgnoreCase(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;margin&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">))</font></font></font>
<font color="#080808">            <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">margin </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= value;</font></font></font>
<font color="#080808">        <font color="#0033b3"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">else if </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">(name.equalsIgnoreCase(</font></font><font color="#067d17"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">&quot;divider&quot;</font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">))</font></font></font>
<font color="#080808">            <font color="#871094"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">divider </font></font></font><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">= value;</font></font></font>
<font color="#080808">    <font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font>
<font color="#080808"><font face="JetBrains Mono, monospace"><font size="1" style="font-size: 8pt">}</font></font></font></pre><p>
Abych mohl vytvořit koncový bod Actuator, musím nějakou službu
anotovat jako <i>@Endpoint</i> s uvedením názvu koncového bodu.</p>
<p>Dále jsem rozšířil implementaci o metody pro:</p>
<ul>
	<li><p><b>čtení parametrů</b></p>
	<p>Metoda je anotovaná jako <i>@ReadOperation</i>.</p>
	<p>Vrací hodnoty parametrů jako slovník, kde klíčem je název
	parametru.</p>
	<li><p><b>změnu parametrů</b></p>
	<p>Metoda anotovaná jako <i>@WriteOperation</i>.</p>
	<p>Jako parametry dostává název parametru a jeho hodnotu.</p>
</ul>
<p>A to je vše, co musíme udělat. 
</p>
<p><br/>
<br/>

</p>
<p>Nyní si již můžeme spustit aplikaci:</p>
<pre class="western" style="margin-bottom: 0.2in">[raska@fedora example-04]$ java -jar target/example-04-1.0.0.jar </pre><p>
<br/>
<br/>

</p>
<p>A mohu se podívat, co říká Actuator o svých koncových
bodech:</p>
<pre class="western">[raska@fedora ~]$ curl -s http://localhost:8080/actuator | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;_links&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;self&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;href&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http://localhost:8080/actuator&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;templated&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">false</font>
    <font size="1" style="font-size: 8pt"><b>},</b></font>
    <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;application&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: {</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;href&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font color="#26a269"><font size="1" style="font-size: 8pt">&quot;http://localhost:8080/actuator/application&quot;</font></font><font size="1" style="font-size: 8pt"><b>,</b></font>
      <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;templated&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">false</font>
    <font size="1" style="font-size: 8pt"><b>}</b></font>
  <font size="1" style="font-size: 8pt"><b>}</b></font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p>
Je vidět, že zná koncový bod <b>application</b>, tak se na něj
můžeme podívat:</p>
<pre class="western">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/application | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;margin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">10</font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;divider&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">2</font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p>
To jsou implicitní hodnoty parametrů, takže zatím to funguje.</p>
<p>A nyní si vyzkouším, jak se projeví jejich změna za běhu.
Pustím si průběžné dotazování na službu, budu měnit
parametry a sledovat, je se jejich změna projeví na výsledku:</p>
<pre class="western">[raska@fedora ~]$ while true; do jo -p nid=local:node02 name=node02 tid=${RANDOM} value=${RANDOM} | curl -s -X GET --data-binary @- -H &quot;Content-type: application/json&quot; http://localhost:8080/rest/serviceA | jq .result; sleep 1; done
<font size="1" style="font-size: 8pt">6</font>
<font size="1" style="font-size: 8pt">0</font>
<font size="1" style="font-size: 8pt">9</font>
<font size="1" style="font-size: 8pt">7</font>
<font size="1" style="font-size: 8pt">593</font>
<font size="1" style="font-size: 8pt">748</font>
<font size="1" style="font-size: 8pt">513</font>
<font size="1" style="font-size: 8pt">364</font>
<font size="1" style="font-size: 8pt">793</font>
<font size="1" style="font-size: 8pt">2</font>
<font size="1" style="font-size: 8pt">12</font>
<font size="1" style="font-size: 8pt">17</font>
0</pre><p>
A souběžně jsem dělal:</p>
<pre class="western">[raska@fedora ~]$ curl -s http://localhost:8080/actuator/application | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;divider&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">2</font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;margin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">10</font>
<font size="1" style="font-size: 8pt"><b>}</b></font>
[raska@fedora ~]$ jo name=margin value=1000 | curl -s -X POST -d @- -H &quot;Content-type: application/json&quot; http://localhost:8080/actuator/application | jq .
[raska@fedora ~]$ jo name=divider value=1000 | curl -s -X POST -d @- -H &quot;Content-type: application/json&quot; http://localhost:8080/actuator/application | jq .
[raska@fedora ~]$ curl -s http://localhost:8080/actuator/application | jq .
<font size="1" style="font-size: 8pt"><b>{</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;divider&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">1000</font><font size="1" style="font-size: 8pt"><b>,</b></font>
  <font color="#12488b"><font size="1" style="font-size: 8pt"><b>&quot;margin&quot;</b></font></font><font size="1" style="font-size: 8pt"><b>: </b></font><font size="1" style="font-size: 8pt">1000</font>
<font size="1" style="font-size: 8pt"><b>}</b></font></pre><p>
Postupně jsem měnil hodnoty parametrů, a jak je vidět, jejich
nastavení se promítlo do výsledku služby.</p>
<p><br/>
<br/>

</p>
</body>
</html>